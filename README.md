# wrc-logger

「EA Sports WRC」向けのペースノートロガー兼ペースノート読み上げツール

## WRCテレメトリについて

このツールはWRCが出力できるテレメトリUDPパケットを受けることで動作します。あらかじめ、UDPパケット出力を有効にしておいてください。

このツールはデフォルトのリッスンポートは「127.0.0.1:20777」です。コマンドラインオプションで変更できます。

「wrc-logger.exe -listen=127.0.0.1:20778」

また、同じパケット内容を転送する機能もあります。既存で同じパケットを利用している場合は以下のように転送オプションを使ってください。

「wrc-logger.exe -forward="192.168.1.1:20777"」

## ロギングの仕掛けについて

- OBSでゲーム画面をフルHD（1920x1080）で取り込み、「仮想カメラ」にて出力
- このツールのロギングを有効にしたら「仮想カメラ」出力のコドライバーOSD表示のマークを画像解析してログを記録します
- ツールのlogフォルダ配下には「ステージ長.log」というファイルが記録されます
- もし既存のファイルがあれば「ステージ長.log.1」「ステージ長.log.2」と番号が付与されて残ります

「wrc-logger.exe -camera 3」というオプションで仮想カメラの選択を変更できます。

## コドライバー読み上げについて

- VoiceVoxというランタイムを利用して音声合成を行います
- 音声生成の基本辞書が「log/base.json」にあります

### 生成のオプション

- 「-actor アクター番号」: VoiceVoxの話者変更
- 「-speed 0.5～2.0」: しゃべる速度
- 「-pitch 0.5～2.0」: 声の高さを変更
- 「-volume 0.5～2.0」: 音量変更
- 「-offset -50..50」: 読み上げのタイミング変更（メートル単位）

# ログのフォーマット

```
0,straight,unknown,50
47.01781152725222,3-right,unknown,140
199.68337484359745,slight-left,twisty,60
...
32032.167246975354,finish,unknown,0
```

「距離,単語１,単語２,単語３」の羅列です。
距離順にソートされている必要があります。

- 単語１には基本辞書のmarksキーワードかコンマを含まない日本語が直接書けます
- 単語２には基本辞書のiconsキーワードかコンマを含まない日本語が直接書けます
- 単語３には基本辞書のdists距離数かコンマを含まない日本語が直接書けます
- 発音しないところには「unknown」を書いておく

